<script type="text/javascript">
    if (typeof userID == 'undefined') {
        window.location.replace('./');
    }
</script>

<div class="row clearfix">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card">
            <div class="header">
                <h2>Setup Your Details</h2>
            </div>
            <div class="body">
                <form name="studentForm" id="form_validation">
                    <div class="form-group">
                        <label class="form-label">Name</label>
                        <div class="form-line">
                            <input type="text" class="form-control" name="name" placeholder="Enter your name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <div class="form-line">
                            <input type="text" class="form-control" name="phone" placeholder="Enter your contact number" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Year</label>
                        <div class="form-line">
                            <input type="radio" name="year" id="4thyear" class="with-gap" value="4th Year" required>
                            <label for="4thyear">4th year</label>

                            <input type="radio" name="year" id="3rdyear" class="with-gap" value="3rd Year" required>
                            <label for="3rdyear" class="m-l-20">3rd year</label>

                            <input type="radio" name="year" id="passedout" class="with-gap" value="Passed Out" required>
                            <label for="passedout" class="m-l-20">Passed Out</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <div class="form-line">
                            <input type="email" class="form-control" name="email" placeholder="Enter your email address" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Degree</label>
                        <div class="form-line">
                            <input type="radio" name="stream" id="cs" class="with-gap" value="CS" required>
                            <label for="cs">Computer Science</label>

                            <input type="radio" name="stream" id="se" class="with-gap" value="SE" required>
                            <label for="se">Software Engineering</label>

                            <input type="radio" name="stream" id="is" class="with-gap" value="IS" required>
                            <label for="is" class="m-l-20">Information Systems</label>
                        </div>
                    </div>
                    <button class="btn btn-primary waves-effect" type="submit" id="submit-btn">SAVE</button>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
function setStudentDetails(e){$("input[name=name]").val(e.name),$("input[name=phone]").val(e.phone),$("input[name=year][value='"+e.year+"']").attr("checked","checked"),$("input[name=email]").val(e.email),$("input[name=stream][value='"+e.stream+"']").attr("checked","checked"),$("#submit-btn").text("UPDATE")}function saveStudentDetails(){var e={};e.name=$("input[name=name]").val(),e.phone=$("input[name=phone]").val(),e.year=$("input[name=year]:checked").val(),e.email=$("input[name=email]").val(),e.stream=$("input[name=stream]:checked").val(),e.userID=userID,$.ajax({type:"POST",url:domain+"student",data:e,dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization",getToken())},success:function(t){1==t.success?(showSuccessMessage(t.msg),studentObject=e,$("#username").text(studentObject.name)):(showErrorMessage("Something went wrong"),console.log(t))},error:function(e,t,o){console.log(e),console.log(t,o)}})}"undefined"==typeof userID?window.location.replace("./"):($.validator.addMethod("regex",function(e,t,o){return o.test(e)},"Please enter a valid phone number. (07xxxxxxxx)"),$(function(){$("#form_validation").validate({rules:{phone:{regex:/^07[0-9]{8}$/}},highlight:function(e){$(e).parents(".form-line").addClass("error")},unhighlight:function(e){$(e).parents(".form-line").removeClass("error")},errorPlacement:function(e,t){$(t).parents(".input-group").append(e),$(t).parents(".form-group").append(e)}})}),$(function(){$.AdminBSB.input.activate(),$.AdminBSB.select.activate()}),$(document).ready(function(){$(function(){$.ajax({type:"GET",url:domain+"student",data:{userID:userID},beforeSend:function(e){e.setRequestHeader("Authorization",getToken())},dataType:"json",success:function(e){1==e.success?e.data.length>0&&setStudentDetails(e.data[0]):(showErrorMessage("Something went wrong"),console.log(e))},error:function(e,t,o){console.log(e),console.log(t,o)}})}),$("#form_validation").submit(function(){return $(this).valid()&&saveStudentDetails(),!1})}));
</script>
